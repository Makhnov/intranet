function whatTheHell(){const e=document.querySelectorAll(".logo-pochoir.right");e.length>0&&iconColors(e);const t=document.querySelector("ul.profile > .avatar");t&&t.addEventListener("click",(e=>t.closest("ul").classList.toggle("cgs-open")));const n=document.querySelectorAll(".cgs-expandable");n.length>0&&expandableImages(n);const c=document.querySelectorAll(".cgs-preview");c.length>0&&preview(c);const o=document.querySelectorAll(".cgs-swap");o.length>0&&swap(o);const s=document.querySelector("footer nav.footer ul.nav-box");s&&footerScroll(s);const l=document.querySelector("cgs-news");l&&newsBlock(l);const i=document.querySelector("#searchColumn form");i&&searchBlock(i);const a=document.querySelectorAll(".cgs-message");a.length>0&&cgsMessages(a);const r=document.getElementById("update-block"),d=document.getElementById("profile-block");r&&d&&profileUpdate(r,d)}function CGSTheme(e,t,n){if(sessionStorage.getItem("selectedColor")){const e=sessionStorage.getItem("selectedColor");document.documentElement.style.setProperty("--cgs-theme-primary",e),console.log("Couleur appliquÃ©e depuis sessionStorage:",e)}else{const e=CGS_COLORS[t];document.documentElement.style.setProperty("--cgs-theme-primary",e),console.log("Couleur appliquÃ©e par dÃ©faut:",e)}}function cgsMessages(e){e.forEach((e=>{const t=e.querySelector(".msg-close");t&&t.addEventListener("click",(()=>e.remove()))}))}function iconColors(e){e.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();const n=e.getAttribute("data-color");var c;c=CGS_COLORS[n],document.documentElement.style.setProperty("--cgs-theme-primary",c),sessionStorage.setItem("selectedColor",c),console.log("Couleur changÃ©e et stockÃ©e en session:",CGS_COLORS[n])}))}))}function expandableImages(e){e.forEach((e=>{e.addEventListener("click",(function(){const e=document.createElement("div");e.classList.add("cgs-fullscreen-container");const t=this.cloneNode();e.appendChild(t),document.body.appendChild(e),e.addEventListener("click",(function(){this.remove()}))}))}))}function preview(e){e.forEach((e=>{e.addEventListener("click",(function(){const t=e.closest("li.list-item").querySelector("div.list-preview");t&&(t.classList.remove("cgs-hidden"),t.addEventListener("click",(function(){t.classList.add("cgs-hidden")})))}))}))}function swap(e){function t(e=!1,t=!1,n){e?t?n.classList.toggle("cgs-width-none"):n.classList.toggle("cgs-height-none"):n.classList.toggle("cgs-hidden")}for(const n of e){const e=n.querySelector(".cgs-swapable"),c=e.querySelectorAll("svg, img"),o=n.querySelector("p.cgs-heading"),s=c[0],l=c[1],i=e.getAttribute("data-smooth"),a=e.getAttribute("data-width");let r=n.nextElementSibling;for(;r;){if(r.classList.contains("cgs-swap-visible")){r.classList.remove("cgs-swap-visible"),n.classList.add("cgs-open");break}if(r.classList.contains("cgs-swap-hidden")){r.classList.remove("cgs-swap-hidden"),n.classList.remove("cgs-open"),t(i,a,r);break}r=r.nextElementSibling}r?e.addEventListener("click",(function(){if(s.classList.toggle("cgs-hidden"),l.classList.toggle("cgs-hidden"),n.classList.toggle("cgs-open"),news=n.closest("cgs-news"),news&&news.classList.toggle("cgs-open"),t(i,a,r),"Afficher"===e.getAttribute("title")){if(e.setAttribute("title","Masquer"),o){const e=o.textContent.replace("Afficher","Masquer");o.textContent=e}}else if(e.setAttribute("title","Afficher"),o){const e=o.textContent.replace("Masquer","Afficher");o.textContent=e}})):e.addEventListener("click",(function(){console.info("Pas de prochain Ã©lÃ©ment Ã  afficher")}))}}function footerScroll(e){const t=getComputedStyle(document.body),n=document.querySelector("footer nav.footer div.cgs-box.left"),c=document.querySelector("footer nav.footer div.cgs-box.right"),o=32*(1.5*parseFloat(t.getPropertyValue("--nav-icon-margin"))+parseFloat(t.getPropertyValue("--nav-icon-size"))),s=()=>{0===e.scrollLeft?n.classList.add("cgs-hidden"):n.classList.remove("cgs-hidden"),e.scrollLeft+e.offsetWidth>=e.scrollWidth?c.classList.add("cgs-hidden"):c.classList.remove("cgs-hidden")};n.addEventListener("click",(()=>{e.scrollLeft-=o})),c.addEventListener("click",(()=>{e.scrollLeft+=o})),e.addEventListener("scroll",s);const l=localStorage.getItem("footerScrollPosition");null!==l&&(e.scrollLeft=parseInt(l)),s(),window.addEventListener("resize",s),window.addEventListener("beforeunload",(()=>{localStorage.setItem("footerScrollPosition",e.scrollLeft)}))}function newsBlock(e){const t=e.querySelector("div.news"),n=e.querySelectorAll("nav.news li");let c=!1;for(const e of n)[...e.classList].some((e=>HIGHLIGHTED.includes(e)))&&(console.log(e),c=!0);n&&c&&t.classList.add("highlighted")}function searchBlock(e){const t=new URLSearchParams(window.location.search),n=document.querySelector("fieldset.active"),c=document.getElementById("activeCategory"),o=c.getAttribute("data-name");console.log("CategoryName : ",o);const s=t.get(o),l=document.querySelectorAll(`input[name="${o}"]`),i=c.getAttribute("data-nom"),a=document.getElementById("activeExtension"),r=t.get("extension"),d=document.querySelectorAll('input[name="extension"]'),u=t.getAll("tag"),g=t.get("query"),m=[t.get("start_date"),t.get("end_date")],f=document.querySelectorAll(".tag-button"),h=document.getElementById("cgs-search-form"),p=document.getElementById("activeTags"),v=document.getElementById("activeQuery"),L=document.getElementById("activeDate");if(l&&l.forEach((e=>{e.addEventListener("change",(function(){S()}))})),d&&d.forEach((e=>{e.addEventListener("change",(function(){S()}))})),f&&f.forEach((e=>{e.addEventListener("click",(function(){E(this.getAttribute("data-tag")),S()}))})),s&&"*"!=s||r&&"*"!=r||g&&""!=g||u.length>0||m[0]||m[1]){if(n.style.display="flex",s){y(c,i,s,(function(){l.forEach((e=>{e.checked=!1})),r||d.forEach((e=>{e.checked=!1})),S()}))}if(r){const e=function(){d.forEach((e=>{e.checked=!1})),s||l.forEach((e=>{e.checked=!1})),S()};y(a,"Fichier",r.split("_")[0],e)}if(g){y(v,"Recherche",g,(function(){document.querySelector('input[name="query"]').value="",S()}))}if(u.length>0&&u.forEach((e=>E(e))),m[0]){y(L,"DÃ©but",m[0],(function(){document.querySelector('input[name="start_date"]').value="",S()}))}if(m[1]){y(L,"Fin",m[1],(function(){document.querySelector('input[name="end_date"]').value="",S()}))}}function y(e,t,n,c){const o=document.createElement("div"),s=document.createElement("p");s.classList.add("active-item");const l=document.createElement("span");l.classList.add("key"),l.textContent=t+" : ";const i=document.createElement("span");i.classList.add("field"),i.textContent=n;const a=document.querySelector("#cgs-close svg").cloneNode(!0);return a.id="svg_close_categorie",a.classList.add("cgs-mid-icon","cgs-close"),a.onclick=c,s.appendChild(l),s.appendChild(i),o.appendChild(s),o.appendChild(a),e.appendChild(o),o}function E(e){if(![...p.children].some((t=>t.textContent.startsWith(e)))){const t=document.createElement("input");t.type="hidden",t.name="tag",t.value=e,h.appendChild(t);const n=function(){h.removeChild(t),p.removeChild(c),S()},c=y(p,"Tag",e,n)}}function S(){h.submit()}}function profileUpdate(e,t){const n=window.location.search;"true"===new URLSearchParams(n).get("form")?(e.classList.remove("cgs-hidden"),t.classList.add("cgs-hidden"),avatarToggle()):(e.classList.add("cgs-hidden"),t.classList.remove("cgs-hidden"),avatarToggle())}function avatarToggle(){const e=document.getElementById("clear_avatar"),t=document.getElementById("preview_avatar");e&&t&&e.addEventListener("click",(function(){const n=t.getAttribute("data-default"),c=t.getAttribute("data-current");console.log(e.checked),e.checked?n===c?(alert("ðŸš« Vous utilisez dÃ©jÃ  l'avatar par dÃ©faut, il n'y a rien Ã  rÃ©initialiser."),e.checked=!1):t.src=n:t.src=c}))}document.addEventListener("DOMContentLoaded",(function(){CGSTheme(USER_THEME,USER_ICONS,USER_AVATAR),whatTheHell()}));const CGS_COLORS={fonce:"#008770",cyan:"#00b3be",clair:"#92d400",gris:"#928b81"},HIGHLIGHTED=["convoc","enquete","amicale"];