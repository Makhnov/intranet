document.addEventListener("DOMContentLoaded",(function(){console.log("Fichier compte_rendu.js chargé");const e=document.querySelectorAll(".cgs-block-docx"),t=document.querySelectorAll("button.chartButton"),o=document.querySelectorAll(".block-chart_block > canvas"),l=document.querySelectorAll(".chartpng");if(t){console.log(o),console.log(t);for(let e=0;e<t.length;e++)t[e].addEventListener("click",(function(){c(o[e].id,l[e])}))}function c(e,t){const o=Chart.getChart(e);if(o){const e=o.toBase64Image();t.src=e}else alert("Instance de graphique non trouvée.")}e.length>0&&function(e){const t=document.querySelectorAll(".cgs-block-docx table");e[0].offsetWidth;if(t)for(let e=0;e<t.length;e++)o(t[e]),l(t[e]);function o(e){const t=e.getAttribute("data-cols");if(!t)return;const o=100/parseInt(t,10)+"%";e.querySelectorAll("td").forEach((e=>{e.style.minWidth=o,e.style.maxWidth=o}))}function l(e){const t=e.getAttribute("data-merge");if(t){JSON.parse(t.replace(/'/g,'"')).forEach((t=>{const o=t.col,l=t.row,c=t.colspan||1,n=t.rowspan||1,r=e.rows[l].cells[o];if(r.colSpan=c,r.rowSpan=n,o+c===e.rows[l].cells.length&&(r.style.borderRight="2px solid black"),l+n===e.rows.length&&(r.style.borderBottom="2px solid black"),n>1){const t=l+n-1;t<e.rows.length&&o>0&&e.rows[t].cells[o-1]&&e.rows[t].cells[o-1].classList.add("cgs-not-last")}})),c(e,!0)}else c(e,!1)}function c(e,t){let o=0;for(let l=0;l<e.rows.length;l++){for(let c=0;c<e.rows[l].cells.length;c++)"None"===e.rows[l].cells[c].innerHTML&&(e.rows[l].cells[c].innerHTML="",t&&o++);if(o>0){for(let t=0;t<o;t++)e.rows[l].deleteCell(-1);o=0}}}}(e)}));