function map(e){let t=43.08366,a=.947,o="Siège de la communauté de communes";"true"===new URLSearchParams(window.location.search).get("home")&&e.dataset.homeLat&&e.dataset.homeLng&&(t=parseFloat(e.dataset.homeLat),a=parseFloat(e.dataset.homeLng),o="Chez moi !");const n=parseFloat(e.dataset.endLat),r=parseFloat(e.dataset.endLng),i=L.map(e).setView([t,a],13);L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(i);const d=L.marker([t,a]).addTo(i).bindPopup(o),s=L.marker([n,r]).addTo(i).bindPopup(`<b>${e.dataset.pointName}</b><br><a href="${e.dataset.pointLink}">Visitez le site</a>`);return i.fitBounds(L.latLngBounds([t,a],[n,r]),{padding:[75,75]}),d._icon.classList.add("map-depart"),s._icon.classList.add("map-destination"),{map:i,start:[t,a],end:[n,r]}}function itineraire(e,t,a){const o=document.querySelector('a[href="/account/profile/"] svg'),n=document.querySelector("a#change-profile"),r=o.cloneNode(!0);n.appendChild(r);try{if(!a)throw new Error("Conteneur des contrôles Leaflet introuvable.");a.href=`https://www.google.com/maps/dir/?api=1&origin=${e[0]},${e[1]}&destination=${t[0]},${t[1]}&travelmode=driving`}catch(e){console.error("Erreur lors de l'ajout du lien Google Maps:",e)}}document.addEventListener("DOMContentLoaded",(function(){console.log("Fichier amicale.js chargé");try{const e=document.getElementById("carte"),t=document.getElementById("open-in-maps");if(!e)throw new Error("Élément de carte introuvable.");const a=map(e);itineraire(a.start,a.end,t)}catch(e){console.info("Erreur lors de l'initialisation de la carte ou absence de carte:",e)}}));